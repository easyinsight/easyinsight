<div cg-busy="load"></div>
<div class="col-md-10" style="border-left: 2px;border-right:2px;border-top:0;border-bottom:0;border-color: #CCC;border-style: solid;margin-top: 0;padding-top: 0">
    <div class="row">
        <div class="col-md-12">
            <h2 style="margin-top: 7px;padding-top: 0">{{data_source.name}}</h2>
        </div>
    </div>
    <div class="row" ng-if="refresh_status_line">
        <div class="col-md-4">
            <div class="progress progress-striped active">
                <div class="progress-bar" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <span>{{ refresh_status_line }}</span>
        </div>
    </div>
    <div class="row" style="margin-bottom:10px" ng-if="user.designer">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-12">
                    <hr class="reportListHR"/>
                </div>
            </div>
            <div class="row">
                <div class="col-md-3">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="btn-toolbar pull-left">
                                <div class="btn-group reportControlBtnGroup">
                                    <div class="dropdown">
                                        <btn class="dropdown-toggle btn btn-alt-primary" data-toggle="dropdown" href="#">
                                            Create
                                            <span class="caret"></span>
                                        </btn>
                                        <ul class="dropdown-menu">
                                            <li>
                                                <a href="/app/embeddedReportEditor.jsp?dataSourceID={{data_source.url_key}}"
                                                   ng-click="$event.stopPropagation()">Create Report
                                                </a>
                                            </li>
                                            <li>
                                                <a href="/app/embeddedDashboardEditor.jsp?dataSourceID={{ data_source.url_key }}"
                                                   ng-click="$event.stopPropagation()">Create Dashboard
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-9">
                    <div class="btn-toolbar pull-right">
                        <div class="btn-group reportControlBtnGroup">
                            <btn class="btn btn-alt-primary"
                                 ng-click="refresh_data_source()">Refresh the Data Source</btn>
                        </div>
                        <div class="btn-group reportControlBtnGroup" style="margin-right: 0;padding-right: 0">
                            <a class="btn btn-alt-primary"
                               href="/app/embeddedConfigureDataSource.jsp?dataSourceID={{ data_source.url_key }}" ng-click="$event.stopPropagation()">Configure
                                the Data Source</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                    <hr class="reportListHR"/>
                </div>
            </div>
        </div>
    </div>
    <!--<div class="row" ng-if="(tags && tags.length > 0) || (numKeys(folders) > 0)">

        <div class="col-md-4" ng-class="{'col-md-offset-8': (!tags || !tags.length)}">
            <div class="dropdown pull-right" is-open="folder_dropdown.status" ng-if="numKeys(folders) > 0 && !tagsEnabled()">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                    {{ current_folder.name }} <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                    <li ng-repeat="(key, value) in folders" ng-class="{selected_folder: (current_folder.id == value.id) }"><a class="folder" ng-click="switch_folder(value)">{{value.name}}</a></li>
                </ul>
            </div>
        </div>
    </div>-->
    <div class="row">
        <div class="col-md-12">
            <div class="row">
                <div class="col-md-9">
                    <h2 id="reportsAndDashboards">Reports and Dashboards</h2>
                </div>
                <div class="col-md-3 deleteSelected">
                    <button ng-if="user.designer" class="btn btn-danger pull-right" ng-click="delete_selected()">Delete Selected</button>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">

            <div ng-if="reports && reports.length == 0" class="noReports">You don't have any reports yet. Click on the Create button above and Create Report to get started!</div>
                <div class="row" ng-repeat="folder in folders">
                    <div ng-if="(filtered_folder_reports = (reports | tagged:tags:folder.id)).length > 0">
                        <div class="row">
                            <div class="col-md-12">
                                <div style="margin-left: 20px;font-weight: 500">{{folder.name}}</div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-md-12">
                                        <table class="table table-striped table-condensed reportDashboardTable">
                                            <tbody>
                                            <tr ng-repeat="report in filtered_folder_reports" ng-init="show_tags = false">
                                                <td ng-show="user.designer" style="width:50px">
                                                    <input type="checkbox" ng-model="report.selected" />
                                                    <i class="glyphicon tag-value" ng-class="{'glyphicon-tag': report.tags.length == 0, 'glyphicon-tags': report.tags.length > 0 }" ng-click="show_tags = !show_tags" />
                                                </td>
                                                <td class="header-tr">
                                                    <div>
                                                        <a href="/app/html/{{report.type}}/{{report.url_key}}" ng-click="$event.stopPropagation()">{{report.name}}</a>
                                                        <a href="/app/html/{{report.type}}/{{report.url_key}}/edit" ng-click="$event.stopPropagation()" style="margin-left:15px;font-size: 10px">Edit</a>
                                                    </div>
                                                    <div ng-show="show_tags">Tags: <span ng-repeat="tag in report.tags">{{tag.name}} <i class="glyphicon glyphicon-remove" ng-click="remove_report_tag(report, tag)" /> </span>
                                                        <input ui-keyup="{'enter': 'add_report_tag(report, null, new_tag)'}" type="text" ng-init="new_tag={}" ng-model="new_tag.text" typeahead="tag.name for tag in tags | filter: {name: $viewValue} | not_tagged:report.tags | limitTo: 8" typeahead-on-select="add_report_tag(report, $item, new_tag)" />
                                                        <i class="glyphicon glyphicon-plus tag-value" ng-click="add_report_tag(report, null, new_tag)" /></div>
                                                </td>
                                                <td ng-show="user.designer"></td>
                                                <td style="width:100px">
                                                    <a href="/app/html/{{report.type}}/{{report.url_key}}" ng-click="$event.stopPropagation()">{{ report.type.capitalize() }}</a>
                                                </td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
        </div>
    </div>
</div>
<div class="col-md-2">
    <div class="row">
        <div class="col-md-12" style="font-weight: bold;margin-bottom: 10px">
            Browse by Tag:
        </div>
    </div>
    <div class="tag-list">
        <div ng-repeat="tag in tags" class="row" style="margin-bottom: 5px">
            <div class="col-md-12">
                <a  class="btn btn-default tag-select" ng-class="{selected: tag.enabled, active: tag.enabled}" data-toggle="button" ng-click="toggleTag(tag)">{{ tag.name }}</a>
            </div>
        </div>
    </div>
</div>
