<?xml version="1.0" ?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:filters="flash.filters.*"
                xmlns:skin="com.easyinsight.skin.*" xmlns:charts3d="ilog.charts3d.*"
                xmlns:series="ilog.charts3d.series.*"
                creationComplete="onCreationComplete()" backgroundColor="#FFFFFF">
    <mx:Script>
        <![CDATA[
        import mx.charts.ChartItem;
        import mx.collections.ArrayCollection;
        import mx.graphics.BitmapFill;
        import mx.graphics.IFill;

        [Bindable]
        [Embed(source="../assets/water4.JPG")]
        private var backgroundDesktop:Class;

        [Bindable]
        [Embed(source="../assets/background2.JPG")]
        private var background2:Class;

        private var timer : Timer;

        [Bindable]
        private var myDataCollection : ArrayCollection;

        [Bindable]
        private var bgFill:BitmapFill;

        [Bindable]
        private var bgFill2:BitmapFill;

        private var bgFills:Array;

        private function onCreationComplete() : void
        {
            bgFills = [];
            for (var i:int = 0; i < 15; i++) {
                var bgFill:BitmapFill = new BitmapFill();
                bgFill.source = backgroundDesktop;
                bgFill.originX = Math.random() * 60;
                bgFill.originY = Math.random() * 60;
                bgFills.push(bgFill);
            }

            myDataCollection = new ArrayCollection();
            generateData();

            timer = new Timer(5000);
            timer.addEventListener(TimerEvent.TIMER, onTimerEvent);
            timer.start();
        }

        private function onTimerEvent(event : TimerEvent) : void
        {
            generateData();
        }

        private function fillFunc(item:ChartItem, index:Number):IFill {
            return bgFills[index % 15];
        }

        private function generateData() : void
        {
            myDataCollection.removeAll();

            for (var x: Number = 0; x < 6; x ++)
            {
                myDataCollection.addItem({ value: Math.random() * 100 });
            }
        }
        ]]>
    </mx:Script>
    <mx:Stroke id="s1" color="#2A7E93" weight="2"/>

    <mx:VBox
            height="100%" width="100%">


        <!--
        <mx:Image source="{backgroundDesktop}" x="10" y="10" width="500" mask="{barchart1}" height="500" cacheAsBitmap="true">
        </mx:Image>
        -->
        <mx:Box backgroundImage="{background2}" backgroundSize="100%">
            <charts3d:BarChart3D id="barchart1" width="500" height="375" dataProvider="{myDataCollection}"
                                 showDataTips="true" elevationAngle="6.5">
                <charts3d:series>
                    <series:BarSeries3D displayName="Series 1" xField="value" fillFunction="fillFunc" stroke="{s1}"/>
                </charts3d:series>
                <charts3d:horizontalAxis>
                    <mx:LinearAxis maximum="100" minimum="0"/>
                </charts3d:horizontalAxis>
            </charts3d:BarChart3D>
        </mx:Box>
        <!--
        <mx:BarChart id="barchart1" width="500" height="375" dataProvider="{myDataCollection}"
                     showDataTips="true">
            <mx:series>
                <mx:BarSeries displayName="Series 1" xField="value" fillFunction="fillFunc"/>
            </mx:series>
            <mx:horizontalAxis>
                <mx:LinearAxis maximum="100" minimum="0"/>
            </mx:horizontalAxis>
        </mx:BarChart>
        -->
        <!-- <skin:Reflection target="{barchart1}" enterFrame="event.target.drawReflection()" height="375" width="500"/> -->

    </mx:VBox>
</mx:Application>