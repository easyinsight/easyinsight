<?xml version="1.0" encoding="utf-8"?>
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" creationComplete="onCreationComplete()">
	<mx:Script>
		<![CDATA[
			import mx.utils.URLUtil;
			import mx.managers.BrowserManager;
			import mx.managers.IBrowserManager;
			import mx.messaging.messages.AsyncMessage;
			private function onCreationComplete():void {
				var browserManager:IBrowserManager = BrowserManager.getInstance();
				browserManager.init();
				var tokenID:String = browserManager.base;				
				var urlObj:Object = URLUtil.stringToObject(browserManager.fragment, "&");
				//var tokenID:String = urlObj.tokenID;
				var callerReference:String = urlObj.callerReference;				
				producer.subtopic = "x";
				var message:AsyncMessage = new AsyncMessage();
				message.body.tokenID = tokenID;
				message.body.callerReference = callerReference;
				producer.send(message);				
			}
		]]>
	</mx:Script>
	
	<mx:Producer id="producer" destination="orderManagement"/>
</mx:Application>
