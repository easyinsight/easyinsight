<?xml version="1.0" encoding="utf-8"?>
<util:EISlimWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml"
                creationComplete="initHandlers()">

    <mx:Script>
		<![CDATA[
        import com.easyinsight.account.Account;
        import com.easyinsight.framework.TORegistry;
        import com.easyinsight.framework.User;

        import com.easyinsight.util.ProgressAlert;

        import mx.collections.ArrayCollection;
        import mx.containers.ViewStack;
        import mx.controls.Alert;
        import mx.events.ListEvent;
        import mx.managers.PopUpManager;

        [Bindable]
        private var dataSourceTypes:ArrayCollection;

        private var _viewStack:ViewStack;

        [Bindable]
        private var _straightToConnect:Boolean;

        public function set straightToConnect(value:Boolean):void {
            _straightToConnect = value;
        }

        public function get viewStack():ViewStack {
            return _viewStack;
        }

        public function set viewStack(val:ViewStack):void {
            _viewStack = val;
        }

        private function initHandlers():void {
            TORegistry.registerTypes();
        }

        private function onFeedCreation(event:UploadConfigEvent):void {
            PopUpManager.removePopUp(this);
        }

        private function cancel():void {
            PopUpManager.removePopUp(this);
        }

        private function create():void {
            var className:String = box.selectedItem as String;
            var dataSourceClass:Class = getDefinitionByName(className) as Class;
            var dataSource:Object = new dataSourceClass();
            ProgressAlert.alert(this, "Sending data source...", null, uploadService.newExternalDataSource);
            uploadService.newExternalDataSource.send(dataSource);
        }

        private function created():void {

        }
		]]>
    </mx:Script>
    <mx:RemoteObject destination="userUpload" id="uploadService">
        <mx:method name="newExternalDataSource" result="created()"/>
    </mx:RemoteObject>
    <mx:VBox>
        <mx:ComboBox id="box">
            <mx:dataProvider>
                <mx:ArrayCollection>
                    <mx:Array>
                        <mx:String>com.easyinsight.salesforce.SalesforceFeedDefinition</mx:String>
                        <mx:String>com.easyinsight.datasources.ConstantContactDataSource</mx:String>
                        <mx:String>com.easyinsight.datasources.FreshbooksDataSource</mx:String>
                    </mx:Array>
                </mx:ArrayCollection>
            </mx:dataProvider>
        </mx:ComboBox>
        <mx:HBox>
            <util:SaveButton label="Create Data Source" click="create()"/>
            <util:CancelButton label="Cancel" click="cancel()"/>
        </mx:HBox>
    </mx:VBox>
</util:EISlimWindow>
