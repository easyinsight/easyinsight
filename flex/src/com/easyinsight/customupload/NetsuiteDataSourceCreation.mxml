<?xml version="1.0" ?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" width="100%" height="100%" implements="com.easyinsight.customupload.IServerDataSourceCreation">
    <mx:Metadata>
        [Event(name="userConfigComplete", type="com.easyinsight.customupload.UploadConfigEvent")]
        [Event(name="userConfigCancel", type="com.easyinsight.customupload.UploadConfigEvent")]
    </mx:Metadata>
    <mx:Script><![CDATA[
        import com.easyinsight.administration.feed.FeedDefinitionData;
        import com.easyinsight.datasources.NetsuiteCompositeSource;

        import mx.collections.ArrayCollection;


        import mx.controls.Button;

        [Bindable]
        private var accountID:String;
        [Bindable]
        private var usernameText:String;

        private var passwordText:String;

        [Bindable]
        private var roleID:String;

        public function get dataSourceDefinition():FeedDefinitionData {
            return new NetsuiteCompositeSource();
        }

        public function setupButton(button:Button):Function {
            return null;
        }

        override protected function createChildren():void {
            super.createChildren();
            var names:Array = [ "Account", "AppPackage", "Budget", "Charge", "Contact", "CouponCode", "Customer", "Employee",
                "InventoryNumber", "Issue", "Item", "ManufacturingRouting", "Nexus",
                "Opportunity", "Partner", "Project",
                "ProjectTask", "ResourceALlocation", "Subsidiary", "TimeBill", "TimeEntry", "TimeSheet", "Transaction", "Vendor"];
            var options:ArrayCollection = new ArrayCollection();
            for each (var n:String in names) {
                options.addItem(new NetsuiteTable(n));
            }
            this.tableOptions = options;
        }

        [Bindable]
        private var tableOptions:ArrayCollection;

        public function set dataSourceDefinition(feedDefinition:FeedDefinitionData):void {
            var ds:NetsuiteCompositeSource = feedDefinition as NetsuiteCompositeSource;
            accountID = ds.accountID;
            usernameText = ds.nsUsername;
            roleID = ds.netsuiteRole;
        }

        public function updateDataSource(feedDefinition:FeedDefinitionData):void {
            var ds:NetsuiteCompositeSource = feedDefinition as NetsuiteCompositeSource;
            ds.accountID = accountIDInput.text;
            ds.nsUsername = userNameInput.text;
            ds.netsuiteRole = roleIDInput.text;
            ds.nsPassword = passwordInput.text;
            var tables:ArrayCollection = new ArrayCollection();
            for each (var o:NetsuiteTable in tableOptions) {
                if (o.selected) {
                    tables.addItem(o.name);
                }
            }
            ds.tables = tables;
        }

        public function validate():Boolean {
            var tables:ArrayCollection = new ArrayCollection();
            for each (var o:NetsuiteTable in tableOptions) {
                if (o.selected) {
                    tables.addItem(o.name);
                }
            }
            return tables.length > 0;
        }
        ]]></mx:Script>
    <mx:HBox>
        <mx:Label text="Netsuite User Name:" width="225" textAlign="right" fontFamily="Tahoma" fontWeight="bold"/>
        <mx:TextInput id="userNameInput" fontWeight="normal" fontFamily="Lucida Grande" text="{usernameText}" width="350"/>
    </mx:HBox>
    <mx:HBox>
        <mx:Label text="Netsuite Password:" width="225" textAlign="right" fontFamily="Tahoma" fontWeight="bold"/>
        <mx:TextInput id="passwordInput" fontWeight="normal" fontFamily="Lucida Grande" displayAsPassword="true" width="350"/>
    </mx:HBox>
    <mx:HBox>
        <mx:Label text="Netsuite Account ID:" width="225" textAlign="right" fontFamily="Tahoma" fontWeight="bold"/>
        <mx:TextInput id="accountIDInput" fontWeight="normal" fontFamily="Lucida Grande" text="{accountID}" width="350"/>
    </mx:HBox>
    <mx:HBox>
        <mx:Label text="Netsuite Role ID:" width="225" textAlign="right" fontFamily="Tahoma" fontWeight="bold"/>
        <mx:TextInput id="roleIDInput" fontWeight="normal" fontFamily="Lucida Grande" text="{roleID}" width="350"/>
    </mx:HBox>
    <mx:Text text="Select one or more tables to pull over:"/>
    <mx:VBox>
        <mx:List dataProvider="{tableOptions}" itemRenderer="com.easyinsight.customupload.NetsuiteTableRenderer" width="300"/>
    </mx:VBox>
</mx:VBox>