<?xml version="1.0" ?>
<feed:DataSourceWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*" width="100%"
                       height="100%"
                       xmlns:feed="com.easyinsight.administration.feed.*" label="Basecamp Configuration">
    <mx:Script><![CDATA[
        import com.easyinsight.administration.feed.FeedDefinitionData;
        import com.easyinsight.datasources.BaseCampDataSource;

        import mx.managers.PopUpManager;

        [Bindable]
        private var url:String;
        [Bindable]
        private var archivedIncluded:Boolean;
        [Bindable]
        private var inactiveIncluded:Boolean;
        [Bindable]
        private var milestoneCommentsIncluded:Boolean;
        [Bindable]
        private var todoCommentsIncluded:Boolean;


        override protected function gotSource():void {
            var ds:BaseCampDataSource = dataSource as BaseCampDataSource;
            url = ds.url;
            archivedIncluded = ds.includeArchived;
            inactiveIncluded = ds.includeInactive;
            milestoneCommentsIncluded = ds.includeMilestoneComments;
            todoCommentsIncluded = ds.includeTodoComments;
            joinProjects = ds.companyProjectJoinMode;
        }

        [Bindable]
        private var joinProjects:Boolean;

        private function save():void {
            var ds:BaseCampDataSource = dataSource as BaseCampDataSource;
            ds.url = urlInput.text;
            ds.includeArchived = archivedCheckbox.selected;
            ds.includeMilestoneComments = milestoneCommentsCheckbox.selected;
            ds.includeTodoComments = todoCommentsCheckbox.selected;
            ds.includeInactive = inactiveCheckbox.selected;
            ds.companyProjectJoinMode = joinCheckbox.selected;
            saveSource();
        }
        ]]></mx:Script>
    <mx:Form paddingLeft="10" paddingRight="10" paddingTop="10" paddingBottom="10">
        <mx:FormItem label="Basecamp URL:">
            <mx:TextInput id="urlInput" fontWeight="normal" fontFamily="Lucida Grande" text="{url}" width="350"/>
        </mx:FormItem>
        <mx:FormItem label="Include On Hold/Inactive Projects:" direction="horizontal">
            <mx:CheckBox id="inactiveCheckbox" selected="{inactiveIncluded}"/>
            <mx:Label text="What is this?" fontSize="10" textDecoration="underline" toolTip="If you don't have a need to report on inactive projects, you can save time on your synchronization by not pulling those projects across into Easy Insight."/>
        </mx:FormItem>
        <mx:FormItem label="Include Archived Projects:" direction="horizontal">
            <mx:CheckBox id="archivedCheckbox" selected="{archivedIncluded}"/>
            <mx:Label text="What is this?" fontSize="10" textDecoration="underline" toolTip="If you don't have a need to report on archived projects, you can save time on your synchronization by not pulling those projects across into Easy Insight."/>
        </mx:FormItem>
        <mx:FormItem label="Include Milestone Comments:" direction="horizontal">
            <mx:CheckBox id="milestoneCommentsCheckbox" selected="{milestoneCommentsIncluded}"/>
            <mx:Label text="What is this?" fontSize="10" textDecoration="underline" toolTip="If you don't have a need to report on milestone comments, you can save significant time on your synchronization by not pulling that field across into Easy Insight."/>
        </mx:FormItem>
        <mx:FormItem label="Include Todo Comments:" direction="horizontal">
            <mx:CheckBox id="todoCommentsCheckbox" selected="{todoCommentsIncluded}"/>
            <mx:Label text="What is this?" fontSize="10" textDecoration="underline" toolTip="If you don't have a need to report on todo comments, you can save dramatic time on your synchronization by not pulling that field across into Easy Insight. Please note that for performance reasons, only comments associated to open todo items will be pulled across if you enable this option."/>
        </mx:FormItem>
        <mx:FormItem label="Join Projects to All Companies" direction="horizontal">
            <mx:CheckBox id="joinCheckbox" selected="{joinProjects}"/>
            <mx:Label text="What is this?" fontSize="10" textDecoration="underline" toolTip="Easy Insight used to join your projects to all companies capable of seeing those projects. We recently changed to instead match Basecamp's behavior and only show the primary company for that project. If you wish to enable the old behavior, check this checkbox."/>
        </mx:FormItem>
	</mx:Form>
    <mx:HBox>
        <util:SaveButton label="Save" click="save()"/>
        <util:CancelButton label="Cancel" click="PopUpManager.removePopUp(this)"/>
    </mx:HBox>
</feed:DataSourceWindow>