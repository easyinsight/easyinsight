<?xml version="1.0" ?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" title="Save Insight"
	creationComplete="addEventListener(KeyboardEvent.KEY_UP, keyHit); focusManager.setFocus(dataSourceName)">
	<mx:Script>
		<![CDATA[
                    import mx.collections.ArrayCollection;
                    import com.easyinsight.analysis.SavedAnalysisEvent;
                    import mx.managers.PopUpManager;
                    import com.easyinsight.analysis.AnalysisDefinition;

                    [Bindable]
                    public var analysisDefinition:AnalysisDefinition;

                    public var compositeFeedNodes:ArrayCollection;
                    public var compositeFeedConnections:ArrayCollection;

                    private function save():void {
                        feedService.createCompositeFeed(compositeFeedNodes, compositeFeedConnections, dataSourceName.text);
                    }

                    private function keyHit(event:KeyboardEvent):void {
                    	if (event.keyCode == Keyboard.ENTER) {
                    		save();
                    	}
                    }

                    private function cancel():void {
                        PopUpManager.removePopUp(this);
                    }

                    private function saved():void {
                    	var feedID:int = feedService.createCompositeFeed.lastResult as int;
                        dispatchEvent(new CompositeFeedSaveEvent(feedID));
                        PopUpManager.removePopUp(this);
                    }
                ]]>
	</mx:Script>
	<mx:VBox styleName="TitleWindowContents" width="100%" height="100%">
		<mx:Form>
			<mx:FormItem label="Data Source Name:" direction="horizontal">
				<mx:TextInput id="dataSourceName"/>
			</mx:FormItem>
			<mx:FormItem label="" direction="horizontal">
				<mx:Button label="Save" click="save()"/>
				<mx:Button label="Cancel" click="cancel()"/>
			</mx:FormItem>
		</mx:Form>
	</mx:VBox>
	<mx:StringValidator source="{dataSourceName}" property="text" minLength="3"/> 
	<mx:RemoteObject destination="feeds" id="feedService">
		<mx:method name="createCompositeFeed" result="saved()"/>
	</mx:RemoteObject>
</mx:TitleWindow>