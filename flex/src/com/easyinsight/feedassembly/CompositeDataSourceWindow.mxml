<?xml version="1.0"?>
<feed:DataSourceWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:feed="com.easyinsight.administration.feed.*"
                       xmlns:util="com.easyinsight.util.*">
    <mx:Script><![CDATA[
        import com.easyinsight.util.PopUpUtil;

        import mx.events.FlexEvent;
        import mx.managers.PopUpManager;

        private function save():void {
            window.updateDataSource(dataSource);
            saveSource();
        }

        private function onCreation(event:FlexEvent):void {
            PopUpUtil.centerPopUp(this);
        }

        override protected function gotSource():void {
            var cDef:CompositeFeedDefinition = dataSource as CompositeFeedDefinition;
            window = new CompositeWorkspace();
            window.addEventListener(FlexEvent.CREATION_COMPLETE, onCreation);
            window.addExistingDef(cDef.compositeFeedNodes, cDef.connections, cDef.dataFeedID, cDef.addonReports);
            addChildAt(window, 0);
        }

        private var window:CompositeWorkspace;
        ]]></mx:Script>

    <mx:HBox>
        <util:SaveButton label="Save" click="save()"/>
        <util:CancelButton label="Cancel" click="PopUpManager.removePopUp(this)"/>
    </mx:HBox>
</feed:DataSourceWindow>
