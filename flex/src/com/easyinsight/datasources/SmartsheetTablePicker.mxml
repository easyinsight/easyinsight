<?xml version="1.0"?>
<util:EISlimWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*"
        creationComplete="uploadService.getSmartsheetTables.send(dataSource)">
    <mx:Script><![CDATA[
        import mx.collections.ArrayCollection;
        import mx.managers.PopUpManager;

        [Bindable]
        private var accounts:ArrayCollection;

        public var dataSource:SmartsheetTableSource;

        private function gotAccounts():void {
            this.accounts = uploadService.getSmartsheetTables.lastResult as ArrayCollection;
        }

        private function chooseAccount():void {
            var account:BasecampNextAccount = accountComboBox.selectedItem as BasecampNextAccount;
            dataSource.table = account.id;
            dataSource.feedName = account.name;
            dispatchEvent(new Event(Event.COMPLETE));
            PopUpManager.removePopUp(this);
        }
        ]]></mx:Script>
    <mx:RemoteObject destination="userUpload" id="uploadService">
        <mx:method name="getSmartsheetTables" result="gotAccounts()"/>
    </mx:RemoteObject>
    <mx:Label text="Choose the Smartsheet sheet you wish to use:"/>
    <mx:ComboBox id="accountComboBox" dataProvider="{accounts}" labelField="name"/>
    <mx:HBox width="100%" horizontalAlign="center">
        <util:SaveButton label="Use This Sheet" click="chooseAccount()"/>
        <util:CancelButton label="Cancel" click="PopUpManager.removePopUp(this)"/>
    </mx:HBox>

</util:EISlimWindow>
