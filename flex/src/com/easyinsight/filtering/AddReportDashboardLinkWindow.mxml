<?xml version="1.0"?>
<util:EISlimWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*">
    <mx:Script><![CDATA[
        import mx.controls.Alert;
        import mx.managers.PopUpManager;
        import mx.validators.Validator;

        [Bindable]
        public var parentChildLabel:String;

        public var settings:GeneralFilterEditSettings;

        public function save():void {
            var results:Array = Validator.validateAll([validator]);
            if (results.length == 0) {
                settings.childParent = parentChildLabelInput.text;
                var rdRule:FilterRuleDefinition = new FilterRuleDefinition();
                rdRule.data = { parentChildLabel: parentChildLabelInput.text};
                rdRule.type = FilterRuleDefinition.REPORT_TO_DASHBOARD_LINK;
                rdRule.label = "Apply the field used in this filter to any dashboard or dashboard stack level filter matching the property of " + parentChildLabelInput.text + ".";
                dispatchEvent(new FilterRuleEvent(FilterRuleEvent.RULE_ADDED, rdRule));
                PopUpManager.removePopUp(this);
            } else {
                Alert.show("You need to define a name for the parent child link.");
            }
        }

        [Bindable]
        private var saveLabel:String = "Add";

        ]]></mx:Script>
    <mx:Text text=""/>
    <mx:Text text="When a dashboard filter is applied to this report with a rule name of "/>
    <mx:TextInput text="{parentChildLabel}" id="parentChildLabelInput"/>
    <mx:Text text="the dashboard filter will be applied on this filter's field instead."/>
    <mx:HBox width="100%" horizontalAlign="center">
        <util:SaveButton label="{saveLabel}" click="save()"/>
        <util:CancelButton label="Cancel" click="PopUpManager.removePopUp(this)"/>
    </mx:HBox>
    <mx:StringValidator id="validator" source="{parentChildLabelInput}" property="text" minLength="1"/>
</util:EISlimWindow>
