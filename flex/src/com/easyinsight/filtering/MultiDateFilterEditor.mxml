<?xml version="1.0"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*"
         implements="com.easyinsight.filtering.IFilterDetailEditor">
    <mx:Script><![CDATA[
        import com.easyinsight.analysis.AnalysisItemTypes;

        import mx.collections.ArrayCollection;

        private var lastValueFilter:MultiFlatDateFilterDefinition;

        [Bindable]
        private var showAll:Boolean;

        [Bindable]
        private var startYear:String;

        public function makeUpdates():FilterDefinition {
            //lastValueFilter.allOption = showAll;
            lastValueFilter.level = dateLevelBox.selectedItem.data;
            lastValueFilter.includeRelative = rollingCheckbox.selected;
            lastValueFilter.unitsBack = startChooser.value;
            lastValueFilter.unitsForward = endChooser.value;
            return lastValueFilter;
        }

        public function set filterDefinition(filterDefinition:FilterDefinition):void {
            lastValueFilter = filterDefinition as MultiFlatDateFilterDefinition;
            dateLevel = lastValueFilter.level;
            rolling = lastValueFilter.includeRelative;
            startValue = lastValueFilter.unitsBack;
            endValue = lastValueFilter.unitsForward;
            /*showAll = lastValueFilter.allOption;
            if (lastValueFilter.startYear > 1900) {
                startYear = String(lastValueFilter.startYear);
            } else {
                startYear = "";
            }*/
        }

        [Bindable]
        private var dateLevel:int;

        [Bindable]
        private var rolling:Boolean;

        [Bindable]
        private var startValue:int;

        [Bindable]
        private var endValue:int;

        [Bindable]
        private var dateLevels:ArrayCollection = new ArrayCollection([ {label: "Month", data: AnalysisItemTypes.MONTH_FLAT},
            {label: "Quarter - Year", data: AnalysisItemTypes.QUARTER_OF_YEAR}]);

        public function set feedID(feedID:int):void {
        }

        public function set fields(value:ArrayCollection):void {
        }
        ]]></mx:Script>
    <mx:Form>
        <!--<mx:FormItem label="All Option:">
            <mx:CheckBox id="allCheckbox" selected="{showAll}"/>
        </mx:FormItem>-->
        <mx:FormItem label="What date level should this filter use?">
            <util:SmartComboBox id="dateLevelBox" selectedProperty="data" selectedValue="{dateLevel}" dataProvider="{dateLevels}"/>
        </mx:FormItem>
        <mx:FormItem label="Should this filter include 'Last Full' and 'This' rolling options?">
            <mx:CheckBox id="rollingCheckbox" selected="{rolling}"/>
        </mx:FormItem>
        <mx:FormItem label="How many increments of the selected date level should this filter go back?">
            <mx:NumericStepper id="startChooser" value="{startValue}" minimum="0" maximum="1000"/>
        </mx:FormItem>
        <mx:FormItem label="How many increments of the selected date level should this filter go forward?">
            <mx:NumericStepper id="endChooser" value="{endValue}" minimum="0" maximum="1000"/>
        </mx:FormItem>
    </mx:Form>
</mx:VBox>
