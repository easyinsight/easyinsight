<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:account="com.easyinsight.account.*" width="100%" height="100%"
         implements="com.easyinsight.listing.IPerspective"
         horizontalAlign="center" left="0" right="0" verticalGap="0" creationComplete="setupListener()">
    <mx:Metadata>
        [Event(name="navigation", type="com.easyinsight.framework.NavigationEvent")]
    </mx:Metadata>
    <mx:states>
        <mx:State name="LoggedIn">
            <mx:RemoveChild target="{swfapp}"/>
            <mx:AddChild relativeTo="{coreBox}">
                <account:AccountCreated/>
            </mx:AddChild>
        </mx:State>
    </mx:states>
    <mx:Script>
		<![CDATA[
        import com.easyinsight.framework.LoginEvent;
import com.easyinsight.framework.User;
        import com.easyinsight.help.ScreencastWindow;
import mx.managers.CursorManager;
import mx.managers.PopUpManager;
        import mx.utils.URLUtil;
        import mx.managers.BrowserManager;

        import com.easyinsight.framework.NavigationEvent;
        import com.easyinsight.listing.AnalyzeSource;
        import com.easyinsight.help.TutorialWindow;

        [Bindable]
        [Embed(source="../../../../assets/media_play.png")]
        private var pointerIcon:Class;

        private function setupListener():void {
            User.getEventNotifier().addEventListener(LoginEvent.LOGIN, onLogin);
            User.getEventNotifier().addEventListener(LoginEvent.LOGOUT, onLogout);
            if (User.getInstance() != null) {
                currentState = "LoggedIn";
            }
        }

        private function onLogin(event:LoginEvent):void {
            currentState = "LoggedIn";
        }

        private function onLogout(event:LoginEvent):void {
            currentState = "";
        }

        public function search(keyword:String):void {

        }

        public function analyze():AnalyzeSource {
            return null;
        }

        public function gotFocus():void {
            var fragmentObject:Object = new Object();
            fragmentObject.page = "intro";
            BrowserManager.getInstance().setTitle("Easy Insight - Intro");
            var fragmentString:String = URLUtil.objectToString(fragmentObject);
            BrowserManager.getInstance().setFragment(fragmentString);
        }

        public function getDefaultAnalyzeState():Boolean {
            return false;
        }

        public function isKeywordSearchInstant():Boolean {
            return false;
        }

        private function toMarketplace():void {
            dispatchEvent(new NavigationEvent("Marketplace"));
        }

        private function toUploads():void {
            dispatchEvent(new NavigationEvent("My Data"));
        }

        private function startTutorials():void {
            var window:TutorialWindow = new TutorialWindow();
            PopUpManager.addPopUp(window, this, false);
            window.x = 20;
            window.y = 80;
        }

        private function lesson1():void {
            var window:ScreencastWindow = new ScreencastWindow();
            window.screencastSource = "../assets/lesson1/training.mp4";
            PopUpManager.addPopUp(window, this);
            window.x = 300;
            window.y = 200;
        }

                ]]>
	</mx:Script>

    <mx:Box width="100%" height="5" backgroundColor="#D42525" left="0" right="0"/>
    <mx:HBox width="100%" height="100%" horizontalAlign="center" backgroundColor="#818285" id="coreBox">
        <mx:Canvas height="100%" backgroundColor="#FFFFFF" id="swfapp">
            <mx:VBox height="100%" horizontalAlign="center">
                <mx:SWFLoader source="IntroApplication.swf"/>
                <!-- <mx:Box width="100%" height="100%" horizontalAlign="center" verticalAlign="middle">
                     <mx:LinkButton label="Need help getting started? Take our tutorials!" fontSize="18" fontFamily="Tahoma"
                                   fontWeight="bold" textDecoration="underline" click="startTutorials()"/>
                </mx:Box> -->
                <mx:Spacer height="30"/>
                <mx:HBox width="100%" horizontalAlign="center">
                    <mx:Label fontSize="16" color="#000000" text="The tutorials below can help you get started with a little more guidance."/>
                </mx:HBox>
                <mx:Spacer height="30"/>
                <mx:HBox width="100%" paddingLeft="20" paddingRight="20" horizontalAlign="center" horizontalGap="40">
                    <mx:VBox horizontalAlign="center">
                        <mx:Image source="../assets/lesson1/FirstFrame.png" width="256" height="192" click="lesson1()" rollOver="CursorManager.setCursor(pointerIcon);"
                                rollOut="CursorManager.removeAllCursors()"/>
                        <mx:HBox>
                            <mx:Label text="Creating a data source" fontSize="14"/>
                        </mx:HBox>
                    </mx:VBox>
                    <mx:VBox horizontalAlign="center">
                        <mx:Box width="256" height="192" backgroundColor="#000000" horizontalAlign="center"  verticalAlign="middle">
                            <mx:Label text="Coming soon..." fontSize="16" color="#FFFFFF"/>
                        </mx:Box>
                        <mx:HBox>
                            <mx:Label text="Running the database solution" fontSize="14"/>
                        </mx:HBox>
                    </mx:VBox>
                    <mx:VBox horizontalAlign="center">
                        <mx:Box width="256" height="192" backgroundColor="#000000" horizontalAlign="center"  verticalAlign="middle">
                            <mx:Label text="Coming soon..." fontSize="16" color="#FFFFFF"/>
                        </mx:Box>
                        <mx:HBox>
                            <mx:Label text="Using the API" fontSize="14"/>
                        </mx:HBox>
                    </mx:VBox>
                </mx:HBox>
            </mx:VBox>
        </mx:Canvas>
    </mx:HBox>
</mx:VBox>
