<?xml version="1.0" ?>
<mx:Module xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:crosstab="com.easyinsight.analysis.crosstab.*" width="100%"
           height="100%" implements="com.easyinsight.analysis.IReportRenderer">
    <mx:Script><![CDATA[
        import com.easyinsight.analysis.AnalysisDefinition;
        import com.easyinsight.analysis.AnalysisItem;
        import com.easyinsight.analysis.Cube;
        import com.easyinsight.analysis.CustomChangeEvent;
        import com.easyinsight.filtering.FilterRawData;

        import com.easyinsight.pseudocontext.PseudoContextWindow;

        import mx.collections.ArrayCollection;
        import mx.events.ListEvent;
        import mx.managers.PopUpManager;

        private var dimension1:AnalysisItem;

        private var crosstabDefinition:CrosstabDefinition;

        public function renderReport(data:ArrayCollection, analysisDefinition:AnalysisDefinition, clientProcessorMap:Object, additionalProperties:Object):void {
            if (data.length > 0) {
                crosstabDefinition = analysisDefinition as CrosstabDefinition;
                dataSet.setStyle("fontFamily", crosstabDefinition.fontName);
                dataSet.setStyle("fontSize", crosstabDefinition.fontSize);
                dimension1 = crosstabDefinition.rows.getItemAt(0) as AnalysisItem;
                var cube:Cube = new Cube();
                cube.populate(crosstabDefinition, data, dataSet);
            }
        }

        public function createFilterRawData():FilterRawData {
            return null;
        }

        public function updateExportMetadata():void {
        }

        private function onClick(event:ListEvent):void {
            var window:PseudoContextWindow = new PseudoContextWindow(dimension1, passThrough, this, crosstabDefinition, event.itemRenderer);
            PopUpManager.addPopUp(window, this);
            var point:Point = new Point(event.itemRenderer.x, event.itemRenderer.y);
            point = localToGlobal(point);
            window.x = point.x + 5;
            window.y = point.y + 5;
        }

        private function passThrough(event:Event):void {
            dispatchEvent(event);
        }

        public function preserveValues():Boolean {
            return false;
        }

        public function onCustomChangeEvent(event:CustomChangeEvent):void {
        }]]></mx:Script>
    <mx:Style>
        OLAPDataGrid {
            fontFamily: "Tahoma";
        }
    </mx:Style>
    <mx:OLAPDataGrid id="dataSet" height="100%" width="100%" itemClick="onClick(event)" fontFamily="Tahoma"/>
</mx:Module>