<?xml version="1.0" encoding="utf-8"?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:analysis="com.easyinsight.analysis.*" xmlns:charts="com.easyinsight.analysis.charts.*">
	<mx:Script>
		<![CDATA[
			import com.easyinsight.analysis.AnalysisItem;
			import com.easyinsight.filtering.FilterDefinition;
			import mx.collections.ArrayCollection;
			import com.easyinsight.analysis.GraphicDefinition;
			import com.easyinsight.analysis.ListDefinition;
			
			private function createListDefinition(graphicDefinition:GraphicDefinition):ListDefinition {
				var listDefinition:ListDefinition = new ListDefinition();
                var columns:ArrayCollection = new ArrayCollection();
                for (var i:int = 0; i < graphicDefinition.dimensions.length; i++) {
                    columns.addItem(graphicDefinition.dimensions[i]);
                }
                for (i = 0; i < graphicDefinition.measures.length; i++) {
                    columns.addItem(graphicDefinition.measures[i]);
                }
                listDefinition.columns = columns;
                var filters:ArrayCollection = new ArrayCollection();
                for each (var filterDefinition:FilterDefinition in graphicDefinition.filterDefinitions) {
                	var keyUsed:Boolean = false;
                	for each (var measure:AnalysisItem in graphicDefinition.measures) {
                		if (measure.key.createString() == filterDefinition.field.key.createString()) {
                			keyUsed = true;
                		}
                	}
                	for each (var dimension:AnalysisItem in graphicDefinition.dimensions) {
                		if (dimension.key.createString() == filterDefinition.field.key.createString()) {
                			keyUsed = true;
                		}
                	}
                	if (!keyUsed) {
                		filters.addItem(filterDefinition);
                	}
                }
                listDefinition.filterDefinitions = filters;
                return listDefinition;
			}
		]]>
	</mx:Script>
	<analysis:ListView />
	<charts:LineChartAdapter/>
</mx:VBox>
