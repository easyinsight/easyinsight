<?xml version="1.0" encoding="utf-8"?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" title="Embedding">
	<mx:Script>
		<![CDATA[
        import mx.managers.PopUpManager;

        [Bindable]
        private var url:String;

        private var _analysisID:int;

        private var _reportType:int;

        private var _dataSourceID:int;

        private var _reportWidth:uint;

        private var _reportHeight:uint;


        public function set reportWidth(value:uint):void {
            _reportWidth = value;
            updateURL();
        }

        public function set reportHeight(value:uint):void {
            _reportHeight = value;
            updateURL();
        }

        public function set reportType(value:int):void {
            _reportType = value;
            updateURL();
        }

        public function set dataSourceID(value:int):void {
            _dataSourceID = value;
            updateURL();
        }

        public function set analysisID(analysisID:int):void {
            this._analysisID = analysisID;
            updateURL();
        }

        private function updateURL():void {
            url = "<object width=\"" + _reportWidth + "\" height=\"" + _reportHeight + "\"><param name=\"movie\" value=\"EmbeddedInsight.swf\" /><param name=\"quality\" value=\"high\" /><param name=\"bgcolor\" value=\"#869ca7\" /><param name=\"allowScriptAccess\" value=\"always\" /><param name=\"flashvars\" value=\"analysisID=" + _analysisID + ",dataSourceID=" + _dataSourceID + ",reportType=" + _reportType + "\"/><embed src=\"https://www.easy-insight.com/app/easyui-debug/EmbeddedInsight.swf\" quality=\"high\" bgcolor=\"#869ca7\" width=\"" + _reportWidth + "\" height=\"" + _reportHeight + "\" name=\"EmbeddedInsight\" align=\"middle\" play=\"true\" loop=\"false\" quality=\"high\" flashvars=\"analysisID=" + _analysisID + ",dataSourceID=" + _dataSourceID + ",reportType=" + _reportType + "\" allowScriptAccess=\"always\" type=\"application/x-shockwave-flash\" pluginspage=\"http://www.adobe.com/go/getflashplayer\"></embed></object>";
        }

        private function copyToClipboard():void {
            System.setClipboard(url);
        }
		]]>
	</mx:Script>
	<mx:VBox>
		<mx:HBox id="quickBox">
			<mx:TextArea editable="false" text="{url}" width="400" height="50" wordWrap="true" id="firstTextArea"/>
			<mx:Button label="Copy to Clipboard" click="copyToClipboard()"/>
		</mx:HBox>
		<mx:Button label="Close" click="PopUpManager.removePopUp(this)"/>
	</mx:VBox>
</mx:TitleWindow>
