<?xml version="1.0" encoding="utf-8"?>
<util:EISlimWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml"
	creationComplete="feedService.searchForSubscribedFeeds.send()">
	<mx:Script>
		<![CDATA[			
			import mx.managers.PopUpManager;

			import mx.rpc.events.ResultEvent;
			import mx.collections.ArrayCollection;
			[Bindable]
			private var descriptors:ArrayCollection;

            public var filterFunction:Function;
		
			private function gotFeeds(event:ResultEvent):void {
				var descs:ArrayCollection = feedService.searchForSubscribedFeeds.lastResult as ArrayCollection;
                if (filterFunction != null) {
                    descs.filterFunction = filterFunction;
                    descs.refresh();
                }
                this.descriptors = descs;
			}
			
			private function chose():void {
				var descriptor:DataSourceDescriptor = feedBox.selectedItem as DataSourceDescriptor;
				dispatchEvent(new FeedSelectionEvent(FeedSelectionEvent.FEED_SELECTED, descriptor));
				PopUpManager.removePopUp(this);
			}
			
			private function cancel():void {
				PopUpManager.removePopUp(this);
			}
		]]>
	</mx:Script>
	<mx:RemoteObject destination="feeds" id="feedService">
		<mx:method name="searchForSubscribedFeeds" result="gotFeeds(event)"/>
	</mx:RemoteObject>
    <mx:HBox>
        <mx:Label text="Choose a Data Source:"/>
        <mx:ComboBox id="feedBox" dataProvider="{descriptors}" selectedIndex="0" labelField="name"/>
    </mx:HBox>
    <mx:HBox horizontalAlign="center" width="100%">
        <util:SaveButton label="Use this Data Source" click="chose()"/>
        <util:CancelButton label="Cancel" click="cancel()"/>
    </mx:HBox>
</util:EISlimWindow>
