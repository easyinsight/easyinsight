<?xml version="1.0" ?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="argh(); refreshData(); addEventListener(DeleteSolutionEvent.DELETE_SOLUTION, onSolutionDelete); addEventListener(SolutionAdminEvent.SOLUTION_ADMIN, refreshRequest)">
    <mx:Script><![CDATA[
        import com.easyinsight.framework.TORegistry;
        import com.easyinsight.util.PopUpUtil;

        import mx.collections.ArrayCollection;
        import mx.managers.PopUpManager;

        private function argh():void {
            TORegistry.registerTypes();
        }

        private function deletedSolution():void {
            refreshData();
        }

        private function onSolutionDelete(event:DeleteSolutionEvent):void {
            solutionService.deleteSolution.send(event.solutionID);
        }

        [Bindable]
        private var solutions:ArrayCollection;

        private function gotSolutions():void {
            this.solutions = solutionService.getSolutions.lastResult as ArrayCollection;
        }

        private function refreshData():void {
            solutionService.getSolutions.send();
        }

        private function refreshRequest(event:SolutionAdminEvent):void {
            solutionService.getSolutions.send();
        }

        private function createSolution():void {
            var window:CreateSolutionWindow = CreateSolutionWindow(PopUpManager.createPopUp(this, CreateSolutionWindow, true));
            window.addEventListener(SolutionAdminEvent.SOLUTION_ADMIN, refreshRequest);
            PopUpUtil.centerPopUp(window);
        }
]]></mx:Script>
    <mx:RemoteObject id="solutionService" destination="solutionService">
        <mx:method name="getSolutions" result="gotSolutions()"/>
        <mx:method name="deleteSolution" result="deletedSolution()"/>
    </mx:RemoteObject>
    <mx:HBox>
        <mx:Button label="Add Connection..." click="createSolution()"/>
        <mx:Button label="Refresh" click="refreshData()"/>        
    </mx:HBox>
    <mx:DataGrid dataProvider="{solutions}" height="100%">
        <mx:columns>
            <mx:DataGridColumn dataField="name" headerText="Name" width="300"/>
            <mx:DataGridColumn dataField="name" width="300" sortable="false" headerText="" itemRenderer="com.easyinsight.solutions.SolutionAdminControls"/>
        </mx:columns>
    </mx:DataGrid>
</mx:VBox>