<?xml version="1.0"?>
<!--
  Created by jamesboe on 1/8/15.
-->
<util:EITitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*"
        creationComplete="onCreation()">
    <mx:Script><![CDATA[
        import com.easyinsight.util.ProgressAlert;

        import mx.collections.ArrayCollection;
        import mx.managers.PopUpManager;

        private function onCreation():void {
            ProgressAlert.alert(this, "Getting activities...", null, exportService.getScheduledActivities);
            var utcOffset:int = new Date().getTimezoneOffset();
            exportService.getScheduledActivities.send(utcOffset);
        }

        private function gotActivities():void {
            availableScheduleOptions = exportService.getScheduledActivities.lastResult as ArrayCollection;
        }

        [Bindable]
        private var availableScheduleOptions:ArrayCollection;

        private function add():void {
            dispatchEvent(new SequenceEvent(SequenceEvent.ADD_TO_SEQUENCE, ScheduledActivity(activityBox.selectedItem)));
            PopUpManager.removePopUp(this);
        }
        ]]></mx:Script>
    <mx:RemoteObject destination="exportService" id="exportService">
        <mx:method name="getScheduledActivities" result="gotActivities()"/>
    </mx:RemoteObject>
    <mx:ComboBox dataProvider="{availableScheduleOptions}" labelField="activityDisplay" id="activityBox"/>
    <mx:HBox width="100%" horizontalAlign="center">
        <util:SaveButton label="Add" click="add()"/>
        <util:CancelButton label="Cancel" click="PopUpManager.removePopUp(this)"/>
    </mx:HBox>
</util:EITitleWindow>
