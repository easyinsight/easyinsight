<?xml version="1.0" ?>
<mx:TitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" headerHeight="8">
    <mx:Script><![CDATA[

        import com.easyinsight.framework.LoginEvent;
        import com.easyinsight.framework.User;

        import mx.core.Application;
        import mx.core.UIComponent;
        import mx.managers.PopUpManager;
        import mx.messaging.config.ServerConfig;

        public static function newWindow(parent:UIComponent):void {
            window = new FloatingGuestWindow();
            var app:Application = Application.application as Application;
            window.y = 0;
            window.x = app.width - 200;
            window.description = User.getInstance().scenario.description;
            PopUpManager.addPopUp(window, parent, false);
        }

        [Bindable]
        private var description:String;

        private static var window:FloatingGuestWindow;

        private function logout():void {
            User.destroy();
            ServerConfig.getChannelSet(authService.destination).logout();
            User.getEventNotifier().dispatchEvent(new LoginEvent(LoginEvent.LOGOUT, null, 1));
            PopUpManager.removePopUp(this);
        }

        public static function destroy():void {
            if (window != null) {
                PopUpManager.removePopUp(window);
                window = null;
            }
        }
        ]]></mx:Script>
    <mx:RemoteObject id="authService" destination="login">
	</mx:RemoteObject>
    <mx:VBox width="200" backgroundColor="#FFFFFF" paddingBottom="5" paddingLeft="5" paddingRight="5" paddingTop="5">
        <mx:TextArea text="You're currently logged in through this guest account:"
                editable="false" selectable="false" width="190" borderStyle="none" backgroundAlpha="0" height="35"/>
        <mx:TextArea text="{description}"
                editable="false" selectable="false" width="190" borderStyle="none" backgroundAlpha="0" height="130"/>
        <mx:TextArea text="Want to switch to another view or ready to create your own account?"
                editable="false" selectable="false" width="190" borderStyle="none" backgroundAlpha="0" height="35"/>
        <mx:HBox width="100%" horizontalAlign="center">
            <mx:Button label="Sign Up" click="logout()"/>
        </mx:HBox>
    </mx:VBox>
</mx:TitleWindow>