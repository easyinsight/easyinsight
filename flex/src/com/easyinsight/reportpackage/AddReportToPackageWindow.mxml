<?xml version="1.0" ?>
<util:EITitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*" creationComplete="retrieveReports()">
    <mx:Script><![CDATA[
        import com.easyinsight.solutions.InsightDescriptor;

        import mx.collections.ArrayCollection;
        import mx.managers.PopUpManager;

        [Bindable]
        private var reports:ArrayCollection;

        private var _dataSourceID:int;

        public function set dataSourceID(value:int):void {
            _dataSourceID = value;
        }

        private function retrieveReports():void {
            if (_dataSourceID == 0)
                analysisService.getInsightDescriptors.send();
            else
                analysisService.getInsightDescriptorsForDataSource.send(_dataSourceID);
        }

        private function gotReports():void {
            reports = analysisService.getInsightDescriptors.lastResult as ArrayCollection;
        }

        private function gotReportsForDataSource():void {
            reports = analysisService.getInsightDescriptorsForDataSource.lastResult as ArrayCollection;
        }

        private function save():void {
            dispatchEvent(new PackageReportEvent(PackageReportEvent.ADD_REPORT, reportBox.selectedItem as InsightDescriptor));
            PopUpManager.removePopUp(this);
        }
        ]]></mx:Script>
    <mx:RemoteObject destination="analysisDefinition" id="analysisService">
        <mx:method name="getInsightDescriptors" result="gotReports()"/>
        <mx:method name="getInsightDescriptorsForDataSource" result="gotReportsForDataSource()"/>
    </mx:RemoteObject>
    <mx:VBox>
        <mx:HBox>
            <mx:Label text="Report: "/>
            <mx:ComboBox id="reportBox" dataProvider="{reports}" labelField="name"/>
        </mx:HBox>
        <mx:HBox>
            <mx:Button label="Add This Report" click="save()"/>
            <mx:Button label="Cancel" click="PopUpManager.removePopUp(this)"/>
        </mx:HBox>
    </mx:VBox>
</util:EITitleWindow>