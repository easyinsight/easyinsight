<?xml version="1.0" ?>
<util:EITitleWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="dataProvider.searchForSubscribedFeeds.send()">
	<mx:Script>
		<![CDATA[
            import com.easyinsight.solutions.DataSourceDescriptor;

            import mx.collections.Sort;
            import mx.collections.SortField;
            import mx.managers.PopUpManager;
			import com.easyinsight.listing.DataFeedDescriptor;
			import mx.collections.ArrayCollection;
			[Bindable]
			private var descriptors:ArrayCollection;

            [Bindable]
            private var rows:int;

			private function gotFeeds():void {
				descriptors = dataProvider.searchForSubscribedFeeds.lastResult as ArrayCollection;
                var sort:Sort = new Sort();
                var sortField:SortField = new SortField("name");
                sort.fields = [ sortField ];
                descriptors.sort = sort;
                descriptors.refresh();
                this.rows = descriptors.length;
			}

			private function chose():void {
				var descriptor:DataFeedDescriptor = feedBox.selectedItem as DataFeedDescriptor;
                var dsD:DataSourceDescriptor = new DataSourceDescriptor();
                dsD.id = descriptor.dataFeedID;
                dsD.name = descriptor.name;
                dispatchEvent(new DataSourceChoiceEvent(dsD));
                PopUpManager.removePopUp(this);
			}

			private function cancel():void {
				PopUpManager.removePopUp(this);
			}
		]]>
	</mx:Script>
	<mx:RemoteObject id="dataProvider" destination="feeds">
		<mx:method name="searchForSubscribedFeeds" result="gotFeeds()"/>
	</mx:RemoteObject>
	<mx:Form styleName="TitleWindowContents">
		<mx:FormItem label="Choose a Data Source:">
			<mx:ComboBox id="feedBox" dataProvider="{descriptors}" selectedIndex="0" labelField="name" rowCount="{rows}"/>
		</mx:FormItem>
		<mx:FormItem label="" direction="horizontal">
			<mx:Button label="OK" click="chose()"/>
			<mx:Button label="Cancel" click="cancel()"/>
		</mx:FormItem>
	</mx:Form>
</util:EITitleWindow>