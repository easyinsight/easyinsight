<?xml version="1.0" encoding="utf-8"?>
<util:EITitleWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute" width="400" height="300"
	creationComplete="doCreationComplete()">
	<mx:Script>
		<![CDATA[
        import com.easyinsight.framework.User;

        import mx.controls.Alert;
        import mx.managers.PopUpManager;


        [Bindable]
        private var file:FileReference = new FileReference();

        private function doBrowse(event:Event):void {
            file.browse();
        }

        public function doCreationComplete():void {
            file.addEventListener(Event.SELECT, doSelect);
            file.addEventListener(Event.COMPLETE, doComplete);
            file.addEventListener(IOErrorEvent.IO_ERROR, onIOError);
        }

        private function onIOError(event:IOErrorEvent):void {
            Alert.show(event.text);
        }

        public function doSelect(event:Event):void {
            fileName.text = file.name;
        }

        public function doSubmit():void {
            /*var request:URLRequest = new URLRequest("/app/ZipUploadServlet");
             var vars:URLVariables = new URLVariables();
             vars.userName = new String(User.getInstance().userName);
             vars.password = new String(User.getInstance().password);
             request.data = vars;

             // Start the file upload process
             file.upload(request);*/
            try {
                file.load();
            } catch(e:Error) {
                Alert.show(e.message);
            }
        }

        private var fileData:ByteArray;

        private function doComplete(event:Event):void {
            try {
                fileData = file.data;
                adminService.updateZips.send(fileData);
            } catch(e:Error) {
                Alert.show(e.message);
            }
        }

        private function cancel():void {
            PopUpManager.removePopUp(this);
        }
		]]>
	</mx:Script>
    <mx:RemoteObject destination="admin" id="adminService">
        <mx:method name="updateZips" result="Alert.show('Successful!')"/>
    </mx:RemoteObject>
	<mx:VBox>
		<mx:TextInput id="fileName" editable="false" />
		<mx:Button label="Browse..." click="doBrowse( event )" />
		<mx:Button label="Submit" click="doSubmit()"/>
		<mx:Button label="Close" click="cancel()"/>
	</mx:VBox>
</util:EITitleWindow>
