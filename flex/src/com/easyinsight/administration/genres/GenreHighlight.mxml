<?xml version="1.0" encoding="utf-8"?>
<mx:HBox xmlns:mx="http://www.adobe.com/2006/mxml">
	<mx:Script>
		<![CDATA[
			import com.easyinsight.analysis.ListDefinition;
			import com.easyinsight.analysis.ChartDefinition;
			import com.easyinsight.analysis.CrosstabDefinition;
			import com.easyinsight.analysis.AnalysisDefinition;
			import com.easyinsight.framework.User;
			import mx.controls.Alert;
			import mx.rpc.events.ResultEvent;
			import mx.rpc.events.FaultEvent;
			import mx.collections.ArrayCollection;
						
			private var genre:String;
			
			public function set genreKey(genre:String):void {
				this.genre = genre;
			}
			
			public function refresh():void {
				var analysisDefinition:ListDefinition = new ListDefinition();
				feedService.getHeadlineAnalysesForGenre.send(genre);
				feedService.getAllAnalysesForGenre.send(genre);				
			}
			
			[Bindable]
			private var headlineAnalyses:ArrayCollection;
			
			[Bindable]
			private var analysisDefinitions:ArrayCollection;
			
			private function gotHeadlines(event:ResultEvent):void {
				headlineAnalyses = feedService.getHeadlineAnalysesForGenre.lastResult as ArrayCollection;
			}
			
			private function failure(event:FaultEvent):void {
				Alert.show(event.message.toString());
			}
			
			private function gotAnalysisDefinitions(event:ResultEvent):void {
				this.analysisDefinitions = feedService.getAllAnalysesForGenre.lastResult as ArrayCollection;
				
				trace("argh");
				var x:int = 0;
								
			}
			
			private function save():void {
				feedService.setHeadlineAnalyses.send(headlineAnalyses, genre);
			}
			
			private function savedHeadlines(event:ResultEvent):void {
				trace("yay");
			}
		]]>
	</mx:Script>
	<mx:RemoteObject id="feedService" destination="feeds">
		<mx:method name="getHeadlineAnalysesForGenre" result="gotHeadlines(event)" fault="failure(event)"/>
		<mx:method name="getAllAnalysesForGenre" result="gotAnalysisDefinitions(event)" fault="failure(event)"/>
		<mx:method name="setHeadlineAnalyses" result="savedHeadlines(event)" fault="failure(event)"/>
	</mx:RemoteObject>
	<mx:VBox>
	<mx:VBox>
		<mx:Label text="Headline Analyses"/>
		<mx:List labelField="title" dataProvider="{headlineAnalyses}" dragEnabled="true" dropEnabled="true"/>
	</mx:VBox>
	<mx:VBox>
		<mx:Label text="Available Analyses"/>	
		<mx:List labelField="title" dataProvider="{analysisDefinitions}" dragEnabled="true" dropEnabled="true"/>
	</mx:VBox>
	<mx:HBox>
		<mx:Button label="Save" click="save()"/>		
	</mx:HBox>
	</mx:VBox>
</mx:HBox>
