<?xml version="1.0" ?>
<mx:VBox xmlns:mx="http://www.adobe.com/2006/mxml" creationComplete="validators = [ nameValidator ]">
    <mx:Script><![CDATA[
        import com.easyinsight.analysis.NamedKey;

        import mx.collections.ArrayCollection;
        import mx.validators.Validator;

        [Bindable]
        private var dimensionName:String;
        private var _dimension:VirtualTransform;

        private var validators:Array;

        override public function set data(val:Object):void {
            var changed:Boolean = false;
            if (_dimension != val) {
                changed = true;
            }
            if (val != null) {
                _dimension = val as VirtualTransform;
                _dimension.setEditor(this);
            }
            if (changed) {
                invalidateProperties();
            }
        }

        override public function get data():Object {
            return _dimension;
        }

        [Bindable]
        private var _values:ArrayCollection;

        public function set values(val:ArrayCollection):void {
            _values = val;
        }

        override protected function commitProperties():void {
            super.commitProperties();
            if (_dimension != null) {
                dimensionName = _dimension.transformDimension.key.createString();
                values = _dimension.stringValues;
            }
        }

        public function save():VirtualTransform {
            var results:Array = Validator.validateAll(validators);
            if (results.length == 0) {
                var existingKey:NamedKey = _dimension.transformDimension.key as NamedKey;
                existingKey.name = nameInput.text;
                
                _dimension.stringValues = ArrayCollection(valuesList.dataProvider);

                return _dimension;
            } else {
                return null;
            }
        }

        ]]></mx:Script>
    <mx:TextInput text="{dimensionName}" id="nameInput"/>
    <mx:List dataProvider="{_values}" dragMoveEnabled="true" id="valuesList" dragEnabled="true" dropEnabled="true"/>
    <mx:StringValidator id="nameValidator" minLength="3" source="{nameInput}" property="text"/>
</mx:VBox>