<?xml version="1.0" ?>
<util:EITitleWindow xmlns:mx="http://www.adobe.com/2006/mxml" xmlns:util="com.easyinsight.util.*"
                    width="500" height="500" creationComplete="setup()"
        paddingTop="5" paddingBottom="5" paddingLeft="5" paddingRight="5" doubleClickEnabled="true">
    <mx:Script><![CDATA[
        import com.easyinsight.customupload.UploadConfigEvent;
        import com.easyinsight.genredata.AnalyzeEvent;

        import mx.collections.ArrayCollection;
        import mx.managers.PopUpManager;

        private function setup():void {
            addEventListener(AnalyzeEvent.ANALYZE, passThrough);
        }

        private function passThrough(event:Event):void {
            //dispatchEvent(event);
            //Alert.show("at least got the event...");
            PopUpManager.removePopUp(this);
        }

        private function onFeedCreation(event:UploadConfigEvent):void {
            PopUpManager.removePopUp(this);
        }

        private function cancel(event:UploadConfigEvent):void {
            PopUpManager.removePopUp(this);
        }

        private var _googleSpreadsheets:ArrayCollection;

        [Bindable(event="googleSpreadsheetsChanged")]
        public function get googleSpreadsheets():ArrayCollection {
            return _googleSpreadsheets;
        }

        public function set googleSpreadsheets(value:ArrayCollection):void {
            if (_googleSpreadsheets == value) return;
            _googleSpreadsheets = value;
            dispatchEvent(new Event("googleSpreadsheetsChanged"));
        }

        private function blah():void {
            var ws:Worksheet;
            var ss:Spreadsheet;
        }

        [Bindable]
        [Embed(source="../../../../assets/tables_x16.png")]
        public var spreadsheetIcon:Class;

        [Bindable]
        [Embed(source="../../../../assets/table_x16.png")]
        public var worksheetIcon:Class;

        private function analyze(event:AnalyzeEvent):void {
            dispatchEvent(event);
        }

        [Bindable]
        private var stackIndex:int = 0;
        ]]>
	</mx:Script>
    <mx:VBox width="100%" height="100%">
        <mx:AdvancedDataGrid width="100%" height="100%"
            id="spreadsheetTree" rowHeight="28" fontSize="12" rowCount="5"
            defaultLeafIcon="{worksheetIcon}" folderOpenIcon="{spreadsheetIcon}" folderClosedIcon="{spreadsheetIcon}">
            <mx:dataProvider>
                <mx:HierarchicalData source="{googleSpreadsheets}"/>
            </mx:dataProvider>
            <mx:columns>
                <mx:AdvancedDataGridColumn headerText="Name" dataField="title" headerRenderer="com.easyinsight.groups.CustomGroupHeader"/>
                <mx:AdvancedDataGridColumn id="spFeed" width="80" sortable="false" headerText="" dataField="url" itemRenderer="com.easyinsight.google.SpreadsheetFeedButton"/>
            </mx:columns>
        </mx:AdvancedDataGrid>
        <mx:HBox width="100%" horizontalAlign="center">
            <util:CancelButton label="Cancel" click="PopUpManager.removePopUp(this)"/>
        </mx:HBox>
    </mx:VBox>

</util:EITitleWindow>