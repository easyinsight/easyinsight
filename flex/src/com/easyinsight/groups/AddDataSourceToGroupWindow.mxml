<?xml version="1.0" encoding="utf-8"?>
<util:EISlimWindow xmlns:util="com.easyinsight.util.*" xmlns:mx="http://www.adobe.com/2006/mxml"
	creationComplete="feedService.searchForSubscribedFeeds.send()">
	<mx:Script>
		<![CDATA[
        import com.easyinsight.solutions.DataSourceDescriptor;

        import mx.collections.Sort;
        import mx.collections.SortField;
        import mx.managers.PopUpManager;



        import mx.collections.ArrayCollection;

        [Bindable]
        private var descriptors:ArrayCollection;

        private var _groupID:int;


        public function set groupID(val:int):void {
            _groupID = val;
        }

        private function gotFeeds():void {
            var descriptors:ArrayCollection = feedService.searchForSubscribedFeeds.lastResult as ArrayCollection;
            var sort:Sort = new Sort();
            sort.fields = [ new SortField("name", true) ];
            descriptors.sort = sort;
            descriptors.refresh();
            this.descriptors = descriptors;
        }

        private function chose():void {
            var descriptor:DataSourceDescriptor = feedBox.selectedItem as DataSourceDescriptor;
            groupService.addFeedToGroup.send(descriptor.id, _groupID);
        }

        private function addedDataSource():void {
            dispatchEvent(new GroupRefreshEvent());
            PopUpManager.removePopUp(this);
        }

        private function cancel():void {
            PopUpManager.removePopUp(this);
        }
		]]>
	</mx:Script>
    <mx:RemoteObject destination="groupService" id="groupService">
		<mx:method name="addFeedToGroup" result="addedDataSource()"/>
	</mx:RemoteObject>
	<mx:RemoteObject destination="feeds" id="feedService">
		<mx:method name="searchForSubscribedFeeds" result="gotFeeds()"/>
	</mx:RemoteObject>
    <mx:Label text="Choose a Data Source:"/>
    <mx:ComboBox id="feedBox" dataProvider="{descriptors}" selectedIndex="0" labelField="name" rowCount="10"/>
    <mx:HBox width="100%" horizontalAlign="center">
        <util:SaveButton label="OK" click="chose()"/>
        <util:CancelButton label="Cancel" click="cancel()"/>
    </mx:HBox>
</util:EISlimWindow>